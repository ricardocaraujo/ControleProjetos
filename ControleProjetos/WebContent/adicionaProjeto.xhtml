<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
		xmlns:h="http://java.sun.com/jsf/html"
		xmlns:f="http://java.sun.com/jsf/core"
		xmlns:ui="http://java.sun.com/jsf/facelets"
		xmlns:p="http://primefaces.org/ui">
		
	<h:head>
		<h:outputStylesheet name="css/estilos.css"/>
	</h:head>

	<ui:composition template="_template.xhtml" rendered="#{not empty adicionaProjetoMB.projeto.nome}">
		
		<ui:define name="titulo" rendered="#{not empty adicionaProjetoMB.projeto.nome}">
			Adiciona Projeto
		</ui:define>
		<ui:define name="conteudo">
			<h:form id="form" enctype="multipart/form-data">
				<h:panelGrid id="tabela" style="width: 920px; font-size: 12px" rowClasses="formAdicionaProjeto" columns="2">
					<p:outputLabel value="Nome do projeto" for="nome"/>
					<p:inputText id="nome" style="width: 400px" value="#{adicionaProjetoMB.projeto.nome}"
						required="true" requiredMessage="Nome obrigatório">					
					</p:inputText>
					
					<p:outputLabel value="Objetivo" for="objetivo"/>
					<p:inputTextarea id="objetivo" style="width: 400px" value="#{adicionaProjetoMB.projeto.objetivo}"/>
					
					<p:outputLabel value="Justificativa" for="justificativa"/>
					<p:inputTextarea id="justificativa" style="width: 400px" value="#{adicionaProjetoMB.projeto.justificativa}"/>
					
					<p:outputLabel value="Data de início" for="dataInicio"/>
					<p:calendar id="dataInicio" value="#{adicionaProjetoMB.projeto.dataInicio.time}" 
								timeZone="America/Sao_Paulo" pattern="dd/MM/yyyy" mask="true"/>
								
					<p:outputLabel value="Data de término" for="dataFim"/>
					<p:calendar id="dataFim" value="#{adicionaProjetoMB.projeto.dataFim.time}" 
								timeZone="America/Sao_Paulo" pattern="dd/MM/yyyy" mask="true"/>
					
					<p:outputLabel value="Situação"/>
					<p:selectOneRadio value="#{adicionaProjetoMB.projeto.situacao}" converter="situacaoEnumConverter">
						<f:selectItems value="#{adicionaProjetoMB.situacoesPossiveis}" var="situacao"
										itemValue="#{situacao}" itemLabel="#{situacao.descricao}"/>
					</p:selectOneRadio>
					
					<p:outputLabel value="Linha de Pesquisa"/>
					<p:selectOneRadio value="#{adicionaProjetoMB.idLinhaDePesquisa}" converter="javax.faces.Integer">
						<f:selectItems value="#{adicionaProjetoMB.linhasDePesquisa}" var="linhaDePesquisa" 
									itemValue="#{linhaDePesquisa.id}" itemLabel="#{linhaDePesquisa.nome}"/>					
					</p:selectOneRadio>
					
					<p:outputLabel value="Coordenadores"/>
					<p:selectManyMenu value="#{adicionaProjetoMB.idDosCoordenadores}" converter="javax.faces.Integer">
						<f:selectItem itemLabel="Nenhum" noSelectionOption="true"/>
						<f:selectItems value="#{adicionaProjetoMB.empregados}" var="coordenador" 
										itemValue="#{coordenador.id}" itemLabel="#{coordenador.nome}"/>
					</p:selectManyMenu>
					
					<p:outputLabel value="Responsáveis Técnicos"/>
					<p:selectManyMenu value="#{adicionaProjetoMB.idDosResponsaveisTecnicos}" converter="javax.faces.Integer">
						<f:selectItem itemLabel="Nenhum" noSelectionOption="true"/>
						<f:selectItems value="#{adicionaProjetoMB.empregados}" var="responsaveisTecnicos"
										itemValue="#{responsaveisTecnicos.id}" itemLabel="#{responsaveisTecnicos.nome}"/>
					</p:selectManyMenu>
										
					<p:outputLabel value="Marco do Projeto"/>											
					<h:form>
						<h:dataTable id="listaMarcos" value="#{adicionaProjetoMB.projeto.marcos}" var="marco">
							<h:column>
								<f:facet name="header">
									<p:outputLabel value="Descrição" />
								</f:facet>
								<p:inputText value="#{marco.descricao}" style="width: 350px" />
							</h:column>
							<h:column>
								<f:facet name="header">
									<p:outputLabel value="Data" />
								</f:facet>
								<p:calendar value="#{marco.data.time}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo"/>
								</p:calendar>
							</h:column>
							<h:column>
								<h:commandLink styleClass="ui-icon ui-icon-closethick">
									<f:ajax listener="#{adicionaProjetoMB.removeMarco(marco)}" 
											immediate="true" execute="@form" render="@form"/>
								</h:commandLink>
							</h:column>
						</h:dataTable>
						<h:commandLink styleClass="ui-icon ui-icon-plusthick">
							<f:ajax listener="#{adicionaProjetoMB.adicionaMarco}" 
									immediate="true" execute="@form" render="@form"/>
						</h:commandLink>
					</h:form>
																		
					<p:outputLabel value="EAP"/>
					<p:fileUpload fileUploadListener="#{adicionaProjetoMB.exibeImagemEap}" showButtons="false"/>
									
					<h:commandButton value="Salvar" action="#{adicionaProjetoMB.adiciona}"/>
					
				</h:panelGrid>
								
				<p:commandButton value="Alterar" onclick="PF('desbloqueio').hide()" rendered="#{not empty adicionaProjetoMB.projeto.nome}"/>				
				<p:blockUI block="tabela" blocked="true" widgetVar="desbloqueio" rendered="#{not empty adicionaProjetoMB.projeto.nome}"/>
							
			</h:form>	
		</ui:define>
	</ui:composition>
</html>
					
					
					