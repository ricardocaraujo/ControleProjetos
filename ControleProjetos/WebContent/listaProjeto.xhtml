<?xml version="1.0" encoding="ISO-8859-1" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
		xmlns:h="http://java.sun.com/jsf/html"
		xmlns:f="http://java.sun.com/jsf/core"
		xmlns:ui="http://java.sun.com/jsf/facelets"
		xmlns:p="http://primefaces.org/ui">
		

		<h:head>
	
		</h:head>
		
		<h:body>
			
			<h:outputStylesheet name="css/estilos.css"/>
			<ui:composition template="_template.xhtml">
				<ui:define name="titulo">
					Lista Projetos
				</ui:define>
			
				<ui:define name="conteudo">	
					<div style="margin-bottom: 30px">
						<h:form>
							<h:panelGrid columns="2">
								<p:outputLabel value="Situação"/>
								<p:selectManyCheckbox value="#{listaProjetoMB.situacoesSelecionadas}" id="situacoes" layout="grid" columns="3" style="padding: 5px" converter="situacaoEnumConverter">
									<f:selectItems value="#{listaProjetoMB.situacoesPossiveis}" var="situacao"
											itemValue="#{situacao}" itemLabel="#{situacao.descricao}"/>	
								</p:selectManyCheckbox>
								<p:outputLabel value="Linhas de pesquisa"/>
								<p:selectManyCheckbox value="#{listaProjetoMB.idLinhasSelecionadas}" id="linhas" layout="grid" columns="3" style="padding: 5px" converter="javax.faces.Integer">
									<f:selectItems value="#{listaProjetoMB.linhasDePesquisa}"  var="linha"
													itemValue="#{linha.id}" itemLabel="#{linha.nome}"/>
								</p:selectManyCheckbox>
							</h:panelGrid>
							<h:commandButton value="Listar" action="#{listaProjetoMB.listaProjetosComFiltro}"/>
						</h:form>
					</div>		
					<div style="margin-bottom: 30px">
						<h:form id="formProjetos">
							<p:dataGrid var="projeto" value="#{listaProjetoMB.listaProjetos}" columns="3" layout="grid"
										rows="12" paginator="true" id="projetos" rowsPerPageTemplate="6,12,16">
											
								<p:panel header="#{projeto.nome}" style="text-align:center">
							        <h:panelGrid columns="2" style="font-size:12px;text-align:left;">
							        	<h:outputLabel value="Objetivo: " styleClass="fonteNegrito"/>
							        	<h:outputText value="#{projeto.objetivo}"/>
							        	<h:outputLabel value="Linha de pesquisa: " styleClass="fonteNegrito"/>
							        	<h:outputText value="#{projeto.linhaDePesquisa.nome}"/>
							        	<h:outputLabel value="Situação: " styleClass="fonteNegrito"/>
							        	<h:outputText value="#{projeto.situacao.descricao}"/>
								    	<h:outputLabel value="Início: " styleClass="fonteNegrito"/>
								    	<h:outputText value="#{projeto.dataInicio.time}">
											<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo"/>
										</h:outputText>
										<h:outputLabel value="Conclusão: " styleClass="fonteNegrito"/>
								    	<h:outputText value="#{projeto.dataFim.time}">
											<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo"/>
										</h:outputText>
										<h:outputLabel value="Resp. técnicos: " styleClass="fonteNegrito"/>
										<p:dataList value="#{projeto.responsaveisTecnicos}" styleClass="semborda" var="responsavel" type="definition">
											#{responsavel.nome}
										</p:dataList>
										<h:outputLabel value="Marcos: " styleClass="fonteNegrito"/>
										<p:dataList value="#{projeto.marcos}" styleClass="semborda" var="marco" type="definition">
											#{marco.descricao}
										</p:dataList>			
							        </h:panelGrid>
							        <h:panelGrid columns="3" style="margin:auto">
							        	<p:commandLink title="Ver detalhes">
			                    			<h:outputText styleClass="ui-icon ui-icon-search" style="margin: auto;" />
			                			</p:commandLink>
							            <p:commandLink title="Editar" action="#{listaProjetoMB.editaProjeto(projeto)}">
				                    		<h:outputText styleClass="ui-icon ui-icon-pencil" style="margin: auto;" />
				                		</p:commandLink>
				                		<p:commandLink title="Apagar" action="#{listaProjetoMB.setProjetoAtual(projeto)}" onclick="PF('dlg').show()">
				                    		<h:outputText styleClass="ui-icon ui-icon-trash" style="margin: auto;" />
						                </p:commandLink>
							        </h:panelGrid>	               
								</p:panel>
							</p:dataGrid>
						</h:form>
					</div>	
					<div>
						<p:dialog widgetVar="dlg" header="Excluir projeto?">
							<h:form>
								<p:panelGrid columns="2">
									<p:commandButton value="Não" onclick="PF('dlg').hide()"/> 
									<p:commandButton value="Sim" action="#{listaProjetoMB.removeProjeto}" onclick="PF('dlg').hide()" update=":formProjetos"/>	
								</p:panelGrid>
							</h:form>
						</p:dialog>
					</div>
					<div>
						<h:form name="graficoProjetos">
							<p:chart type="bar" model="#{listaProjetoMB.grafico}" style="height:300px"/>
						</h:form>
					</div>							
				</ui:define>
			</ui:composition>

		</h:body>
</html>